Ò¢ë*UıJï á˘ïPCü˘¥$Ãã˙HÆaÙ
ï*UıH/cˆk€∑Aˆ1sÙ
ï*UıHÜäÒCE<ü˙HBü˙≥¢?A˙ß√ô˘4Í>A˜î‚‘A˙ß√ô˘4Í Qı/ü˜î‚‘A˙ß√ô˘4Í y¯sÁSA˜T)Iù˙àP•˘ÊIß˙èü ÒCE<â¯±§ŒãÙ®Rì˘’(AÙë"∆AÙëê E˘Ù*Iü˘–f"Aı Œâ˘ëiSAı
T†E˘–f≈EÙ™NSÒ¢ëƒã¯s(Aı	"EçÙ
^Lì˙uFì˚ Œ≥˜ FAı0gYAı#E<°˙S„†Qı#E˜é©≈©˚Û`“è˘3ê0A˜√E<u˙/Œã˙Û$ŒãÙíFA˜√E<u˙/ƒã¯“gI©˘3Á ]Ùë"∆Aı…# }Ò¢û:°˙óÁEØ˘ígEAı…# }Ò¢üDü˘—P>ÒO)≈© PROCLIST <CONS :PT_NEWLINE .PROCLIST>> 

<DEFINE :PT_NEWLINE ( $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($F )ANY )
<PROG ()

<:PT_NEXTLINE <:GET_MARGIN >.$F >
>DONE >
<SET PROCLIST <CONS :PT_NEXTLINE .PROCLIST>> 

<DEFINE :PT_NEXTLINE ( $I $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($I )FIX ($F )ANY )
<PROG ()

<:FILE$PUTC .$F #CHARACTER 10 >
<PROG ($J K I)#DECL (($J K I)FIX)<SET I 1 ><SET K .$I ><SET $J .I><REPEAT () <COND (<L? .K .$J > <RETURN>)> 
<PROG ()
<:FILE$PUTC .$F #CHARACTER 32 >
><SET $J <+ 1 .$J >>>>
>DONE >
<SET PROCLIST <CONS :NEW_MARGIN .PROCLIST>> 

<DEFINE :NEW_MARGIN ( $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($F )ANY )
<PROG ()

<:SET_MARGIN <:FILE$COLUMN .$F >>
>DONE >
<SET PROCLIST <CONS :PT_STRID .PROCLIST>> 

<DEFINE :PT_STRID ( $ID $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($ID )ANY ($F )ANY )
<PROG ()

<:PT_STR <:STRID$GET_STR .$ID >.$F >
>DONE >
<SET PROCLIST <CONS :PT_STR .PROCLIST>> 

<DEFINE :PT_STR ( $S $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($S )STRING ($F )ANY )
<PROG ()

<:FILE$PUTC .$F #CHARACTER 34 >
<:PT_CHARSEQ .$S T .$F >
<:FILE$PUTC .$F #CHARACTER 34 >
>DONE >
<SET PROCLIST <CONS :PT_INTID .PROCLIST>> 

<DEFINE :PT_INTID ( $ID $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($ID )ANY ($F )ANY )
<PROG ()

<:FILE$PUTI .$F <:INTID$GET_INT .$ID >>
>DONE >
<SET PROCLIST <CONS :PT_CHARID .PROCLIST>> 

<DEFINE :PT_CHARID ( $ID $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($ID )ANY ($F )ANY )
<PROG ()

<:PT_CHAR <:CHARID$GET_CHAR .$ID >.$F >
>DONE >
<SET PROCLIST <CONS :PT_CHAR .PROCLIST>> 

<DEFINE :PT_CHAR ( $C $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($C )CHARACTER ($F )ANY )
<PROG ()

<:FILE$PUTS .$F "'">
<:PT_CHARSEQ <STRING$C2S .$C >#FALSE () .$F >
<:FILE$PUTS .$F "'">
>DONE >
<SET PROCLIST <CONS :PT_NAME .PROCLIST>> 

<DEFINE :PT_NAME ( $N $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($N )ANY ($F )ANY )
<PROG ()

<:FILE$PUTS .$F <:NAME$GET_STR .$N >>
>DONE >
<SET PROCLIST <CONS :PT_IDN .PROCLIST>> 

<DEFINE :PT_IDN ( $I $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($I )ANY ($F )ANY )
<PROG ()

<:FILE$PUTS .$F <:IDN$GET_STR .$I >>
>DONE >
<SET PROCLIST <CONS :PT_CHARSEQ .PROCLIST>> 

<DEFINE :PT_CHARSEQ ( $S $IS_STR $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($S )STRING ($IS_STR )<OR ATOM FALSE>($F )ANY )
<PROG ()

<PROG ($I K I)#DECL (($I K I)FIX)<SET I 1 ><SET K <STRING$SIZE .$S >><SET $I .I><REPEAT () <COND (<L? .K .$I > <RETURN>)> 
<PROG ($C $J )#DECL ( ($C )CHARACTER ($J )FIX )
<SET $C <STRING$FETCH .$S .$I >>
<SET $J <CHAR$C2I .$C >>
<COND (<INT$LT .$J 32 >
<PROG ()
<:FILE$PUTC .$F #CHARACTER 92 >
<:FILE$PUTC .$F <CHAR$I2C <INT$ADD .$J 64 >>>
>)(T 
<COND (<INT$EQUAL .$J 34 >
<COND (.$IS_STR 
<:FILE$PUTS .$F "\\\"">)(T 
<:FILE$PUTC .$F #CHARACTER 34 >)>)(T 
<COND (<INT$EQUAL .$J 39 >
<COND (.$IS_STR 
<:FILE$PUTC .$F #CHARACTER 39 >)(T 
<:FILE$PUTS .$F "\\'">)>)(T 
<COND (<INT$EQUAL .$J 92 >
<:FILE$PUTS .$F "\\\\">)(T 
<:FILE$PUTC .$F .$C >)>)>)>)>
><SET $I <+ 1 .$I >>>>
>DONE >
<SET PROCLIST <CONS :PT_CONSTLIST .PROCLIST>> 

<DEFINE :PT_CONSTLIST ( $LIST $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($LIST )<VECTOR UVECTOR FIX FIX FIX>($F )ANY )
<PROG ()

<:PT_KONSTLIST .$LIST "[]".$F >
>DONE >
<SET PROCLIST <CONS :PT_KONSTLIST .PROCLIST>> 

<DEFINE :PT_KONSTLIST ( $LIST $BRACKETS $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($LIST )<VECTOR UVECTOR FIX FIX FIX>($BRACKETS )STRING ($F )ANY )
<PROG ($HIGH )#DECL ( ($HIGH )FIX )

<COND (<INT$EQUAL <ARRAY$SIZE .$LIST >0 >
<RETURN DONE .RTN >)(T 
#FALSE () )>
<:FILE$PUTC .$F <STRING$FETCH .$BRACKETS 1 >>
<SET $HIGH <ARRAY$HIGH .$LIST >>
<PROG ($I K I)#DECL (($I K I)FIX)<SET I <ARRAY$LOW .$LIST >><SET K .$HIGH ><SET $I .I><REPEAT () <COND (<L? .K .$I > <RETURN>)> 
<PROG ()
<:PT_CONST <ARRAY$FETCH .$LIST .$I >.$F >
<COND (<INT$LT .$I .$HIGH >
<:FILE$PUTS .$F ", ">)(T 
<:FILE$PUTC .$F <STRING$FETCH .$BRACKETS 2 >>)>
><SET $I <+ 1 .$I >>>>
>DONE >
<SET PROCLIST <CONS :PT_NAMELIST .PROCLIST>> 

<DEFINE :PT_NAMELIST ( $LIST $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($LIST )<VECTOR UVECTOR FIX FIX FIX>($F )ANY )
<PROG ($HIGH )#DECL ( ($HIGH )FIX )

<SET $HIGH <ARRAY$HIGH .$LIST >>
<PROG ($I K I)#DECL (($I K I)FIX)<SET I <ARRAY$LOW .$LIST >><SET K .$HIGH ><SET $I .I><REPEAT () <COND (<L? .K .$I > <RETURN>)> 
<PROG ()
<:PT_NAME <ARRAY$FETCH .$LIST .$I >.$F >
<COND (<INT$LT .$I .$HIGH >
<:FILE$PUTS .$F ", ">)(T 
#FALSE () )>
><SET $I <+ 1 .$I >>>>
>DONE >
<SET PROCLIST <CONS :PT_IDNLIST .PROCLIST>> 

<DEFINE :PT_IDNLIST ( $LIST $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($LIST )<VECTOR UVECTOR FIX FIX FIX>($F )ANY )
<PROG ($HIGH )#DECL ( ($HIGH )FIX )

<SET $HIGH <ARRAY$HIGH .$LIST >>
<PROG ($I K I)#DECL (($I K I)FIX)<SET I <ARRAY$LOW .$LIST >><SET K .$HIGH ><SET $I .I><REPEAT () <COND (<L? .K .$I > <RETURN>)> 
<PROG ()
<:PT_IDN <ARRAY$FETCH .$LIST .$I >.$F >
<COND (<INT$LT .$I .$HIGH >
<:FILE$PUTS .$F ", ">)(T 
#FALSE () )>
><SET $I <+ 1 .$I >>>>
>DONE >
<SET PROCLIST <CONS :PT_TYPELIST .PROCLIST>> 

<DEFINE :PT_TYPELIST ( $LIST $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($LIST )<VECTOR UVECTOR FIX FIX FIX>($F )ANY )
<PROG ($HIGH )#DECL ( ($HIGH )FIX )

<SET $HIGH <ARRAY$HIGH .$LIST >>
<PROG ($I K I)#DECL (($I K I)FIX)<SET I <ARRAY$LOW .$LIST >><SET K .$HIGH ><SET $I .I><REPEAT () <COND (<L? .K .$I > <RETURN>)> 
<PROG ()
<:PT_TYPESPEC <ARRAY$FETCH .$LIST .$I >.$F >
<COND (<INT$LT .$I .$HIGH >
<:FILE$PUTS .$F ", ">)(T 
#FALSE () )>
><SET $I <+ 1 .$I >>>>
>DONE >
<SET PROCLIST <CONS :PT_STMTLIST .PROCLIST>> 

<DEFINE :PT_STMTLIST ( $LIST $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($LIST )<VECTOR UVECTOR FIX FIX FIX>($F )ANY )
<PROG ($HIGH )#DECL ( ($HIGH )FIX )

<SET $HIGH <ARRAY$HIGH .$LIST >>
<PROG ($I K I)#DECL (($I K I)FIX)<SET I <ARRAY$LOW .$LIST >><SET K .$HIGH ><SET $I .I><REPEAT () <COND (<L? .K .$I > <RETURN>)> 
<PROG ()
<:PT_STMT <ARRAY$FETCH .$LIST .$I >.$F >
<:FILE$PUTC .$F #CHARACTER 59 >
<COND (<INT$LT .$I .$HIGH >
<:PT_NEWLINE .$F >)(T 
#FALSE () )>
><SET $I <+ 1 .$I >>>>
>DONE >
<SET PROCLIST <CONS :PT_EXPRLIST .PROCLIST>> 

<DEFINE :PT_EXPRLIST ( $LIST $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($LIST )<VECTOR UVECTOR FIX FIX FIX>($F )ANY )
<PROG ($HIGH )#DECL ( ($HIGH )FIX )

<SET $HIGH <ARRAY$HIGH .$LIST >>
<PROG ($I K I)#DECL (($I K I)FIX)<SET I <ARRAY$LOW .$LIST >><SET K .$HIGH ><SET $I .I><REPEAT () <COND (<L? .K .$I > <RETURN>)> 
<PROG ()
<:PT_EXPR <ARRAY$FETCH .$LIST .$I >.$F >
<COND (<INT$LT .$I .$HIGH >
<:FILE$PUTS .$F ", ">)(T 
#FALSE () )>
><SET $I <+ 1 .$I >>>>
>DONE >
<SET PROCLIST <CONS :PT_EQUATELIST .PROCLIST>> 

<DEFINE :PT_EQUATELIST ( $LIST $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($LIST )<VECTOR UVECTOR FIX FIX FIX>($F )ANY )
<PROG ($HIGH )#DECL ( ($HIGH )FIX )

<SET $HIGH <ARRAY$HIGH .$LIST >>
<PROG ($I K I)#DECL (($I K I)FIX)<SET I <ARRAY$LOW .$LIST >><SET K .$HIGH ><SET $I .I><REPEAT () <COND (<L? .K .$I > <RETURN>)> 
<PROG ()
<:PT_EQUATE <ARRAY$FETCH .$LIST .$I >.$F >
<:FILE$PUTC .$F #CHARACTER 59 >
<COND (<INT$LT .$I .$HIGH >
<:PT_NEWLINE .$F >
)(T 
#FALSE () )>
><SET $I <+ 1 .$I >>>>
>DONE >
<SET PROCLIST <CONS :PT_APPLY .PROCLIST>> 

<DEFINE :PT_APPLY ( $OP $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($OP )<VECTOR ANY <VECTOR UVECTOR FIX FIX FIX>>($F )ANY )
<PROG ()

<:PT_IDN <RECORD$GET 1 .$OP >.$F >
<:PT_CONSTLIST <RECORD$GET 2 .$OP >.$F >
>DONE >
<SET PROCLIST <CONS :PT_CLUSTEROP .PROCLIST>> 

<DEFINE :PT_CLUSTEROP ( $OP $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($OP )<VECTOR ANY <VECTOR UVECTOR FIX FIX FIX>ANY >($F )ANY )
<PROG ()

<:PT_TYPESPEC <RECORD$GET 3 .$OP >.$F >
<:FILE$PUTC .$F #CHARACTER 36 >
<:PT_NAME <RECORD$GET 1 .$OP >.$F >
<:PT_CONSTLIST <RECORD$GET 2 .$OP >.$F >
>DONE >
<SET PROCLIST <CONS :PT_ONEUP .PROCLIST>> 

<DEFINE :PT_ONEUP ( $UP1 $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($UP1 )<VECTOR ANY ANY ANY >($F )ANY )
<PROG ()

<:PT_TYPESPEC <RECORD$GET 3 .$UP1 >.$F >
<:FILE$PUTS .$F "$make_">
<:PT_NAME <RECORD$GET 2 .$UP1 >.$F >
<:FILE$PUTC .$F #CHARACTER 40 >
<:PT_CONST <RECORD$GET 1 .$UP1 >.$F >
<:FILE$PUTC .$F #CHARACTER 41 >
>DONE >
<SET PROCLIST <CONS :PT_CONSTREF .PROCLIST>> 

<DEFINE :PT_CONSTREF ( $REF $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($REF )<VECTOR ANY <VECTOR UVECTOR FIX FIX FIX>>($F )ANY )
<PROG ()

<:PT_IDN <RECORD$GET 1 .$REF >.$F >
<:PT_CONSTLIST <RECORD$GET 2 .$REF >.$F >
>DONE >
<SET PROCLIST <CONS :PT_CONST .PROCLIST>> 

<DEFINE :PT_CONST ( $C $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($C )ANY ($F )ANY )
<PROG ()

<:PT_CONSTABS <:CONST$GET_PRINT .$C >.$F >
>DONE >
<SET PROCLIST <CONS :PT_CONSTABS .PROCLIST>> 

<DEFINE :PT_CONSTABS ( $CA $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($CA )<LIST FIX ANY>($F )ANY )
<PROG ($X )#DECL ( ($X )<LIST FIX ANY>)

<SET $X .$CA >
<PROG (OLDGUY) #DECL ((OLDGUY) <LIST FIX ANY>) <SET OLDGUY .$X ><PROG (TG $X ) #DECL ((TG) FIX) <SET TG <NTH .OLDGUY 1>><SET $X <NTH .OLDGUY 2>> <COND 
(<==? .TG 6 >
<:PT_INTID .$X .$F >)
(<==? .TG 3 >
<:FILE$PUTS .$F <COND (.$X "true") (T "false")> >)
(<==? .TG 4 >
<:PT_CHARID .$X .$F >)
(<==? .TG 12 >
<:PT_STRID .$X .$F >)
(<==? .TG 7 >
<:FILE$PUTS .$F "nil">)
(<==? .TG 8 >
<:PT_ONEUP .$X .$F >)
(<==? .TG 13 >
<:PT_TYPESPEC .$X .$F >)
(<==? .TG 5 >
<PROG ()
<:FILE$PUTS .$F "force[">
<:PT_TYPESPEC .$X .$F >
<:FILE$PUTC .$F #CHARACTER 41 >
>)
(<==? .TG 1 >
<:PT_APPLY .$X .$F >)
(<==? .TG 9 >
<:PT_CLUSTEROP .$X .$F >)
(<==? .TG 10 >
<:PT_IDN .$X .$F >)
(<==? .TG 11 >
<:PT_CONSTREF .$X .$F >)
(<==? .TG 14 >
<:PT_EXPR .$X .$F >)
(<==? .TG 2 >
<:FILE$PUTS .$F "?const?">)>>>
>DONE >
<SET PROCLIST <CONS :PT_OPNAME .PROCLIST>> 

<DEFINE :PT_OPNAME ( $OP $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($OP )<VECTOR ANY <VECTOR UVECTOR FIX FIX FIX>>($F )ANY )
<PROG ()

<:PT_NAME <RECORD$GET 1 .$OP >.$F >
<:PT_CONSTLIST <RECORD$GET 2 .$OP >.$F >
>DONE >
<SET PROCLIST <CONS :PT_OPNAMELIST .PROCLIST>> 

<DEFINE :PT_OPNAMELIST ( $LIST $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($LIST )<VECTOR UVECTOR FIX FIX FIX>($F )ANY )
<PROG ($HIGH )#DECL ( ($HIGH )FIX )

<SET $HIGH <ARRAY$HIGH .$LIST >>
<PROG ($I K I)#DECL (($I K I)FIX)<SET I <ARRAY$LOW .$LIST >><SET K .$HIGH ><SET $I .I><REPEAT () <COND (<L? .K .$I > <RETURN>)> 
<PROG ()
<:PT_OPNAME <ARRAY$FETCH .$LIST .$I >.$F >
<COND (<INT$LT .$I .$HIGH >
<:FILE$PUTS .$F ", ">)(T 
#FALSE () )>
><SET $I <+ 1 .$I >>>>
>DONE >
<SET PROCLIST <CONS :PT_OPERDECL .PROCLIST>> 

<DEFINE :PT_OPERDECL ( $DEC $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($DEC )<VECTOR <VECTOR UVECTOR FIX FIX FIX>ANY >($F )ANY )
<PROG ()

<:PT_OPNAMELIST <RECORD$GET 1 .$DEC >.$F >
<:FILE$PUTS .$F ": ">
<:PT_TYPESPEC <RECORD$GET 2 .$DEC >.$F >
>DONE >
<SET PROCLIST <CONS :PT_OPERDECLLIST .PROCLIST>> 

<DEFINE :PT_OPERDECLLIST ( $LIST $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($LIST )<VECTOR UVECTOR FIX FIX FIX>($F )ANY )
<PROG ($HIGH )#DECL ( ($HIGH )FIX )

<SET $HIGH <ARRAY$HIGH .$LIST >>
<PROG ($I K I)#DECL (($I K I)FIX)<SET I <ARRAY$LOW .$LIST >><SET K .$HIGH ><SET $I .I><REPEAT () <COND (<L? .K .$I > <RETURN>)> 
<PROG ()
<:PT_OPERDECL <ARRAY$FETCH .$LIST .$I >.$F >
<COND (<INT$LT .$I .$HIGH >
<PROG ()
<:FILE$PUTC .$F #CHARACTER 44 >
<:PT_NEWLINE .$F >
>)(T 
#FALSE () )>
><SET $I <+ 1 .$I >>>>
>DONE >
<SET PROCLIST <CONS :PT_TYPESET .PROCLIST>> 

<DEFINE :PT_TYPESET ( $SET $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($SET )<VECTOR <VECTOR UVECTOR FIX FIX FIX>ANY <VECTOR UVECTOR FIX FIX FIX>>($F )ANY )
<PROG ($MARGIN $MAR )#DECL ( ($MARGIN )FIX ($MAR )FIX )

<SET $MARGIN <:GET_MARGIN >>
<:FILE$PUTS .$F "{ ">
<:PT_IDN <RECORD$GET 2 .$SET >.$F >
<:FILE$PUTS .$F " | ">
<SET $MAR <:FILE$COLUMN .$F >>
<:PT_IDN <RECORD$GET 2 .$SET >.$F >
<:FILE$PUTS .$F " has ">
<:NEW_MARGIN .$F >
<:PT_OPERDECLLIST <RECORD$GET 3 .$SET >.$F >
<:FILE$PUTC .$F #CHARACTER 59 >
<:SET_MARGIN .$MAR >
<:PT_NEWLINE .$F >
<:PT_EQUATELIST <RECORD$GET 1 .$SET >.$F >
<:FILE$PUTC .$F #CHARACTER 125 >
<:SET_MARGIN .$MARGIN >
>DONE >
<SET PROCLIST <CONS :PT_RENAME .PROCLIST>> 

<DEFINE :PT_RENAME ( $TAB $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($TAB )<VECTOR ANY <VECTOR UVECTOR FIX FIX FIX>>($F )ANY )
<PROG ()

<:PT_NAMELIST <RECORD$GET 2 .$TAB >.$F >
<:FILE$PUTS .$F " to ">
<:PT_NAME <RECORD$GET 1 .$TAB >.$F >
>DONE >
<SET PROCLIST <CONS :PT_RENAMELIST .PROCLIST>> 

<DEFINE :PT_RENAMELIST ( $LIST $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($LIST )<VECTOR UVECTOR FIX FIX FIX>($F )ANY )
<PROG ($MARGIN $HIGH )#DECL ( ($MARGIN )FIX ($HIGH )FIX )

<SET $MARGIN <:GET_MARGIN >>
<SET $HIGH <ARRAY$HIGH .$LIST >>
<:FILE$PUTC .$F #CHARACTER 91 >
<:NEW_MARGIN .$F >
<PROG ($I K I)#DECL (($I K I)FIX)<SET I <ARRAY$LOW .$LIST >><SET K .$HIGH ><SET $I .I><REPEAT () <COND (<L? .K .$I > <RETURN>)> 
<PROG ()
<:PT_RENAME <ARRAY$FETCH .$LIST .$I >.$F >
<COND (<INT$LT .$I .$HIGH >
<PROG ()
<:FILE$PUTC .$F #CHARACTER 44 >
<:PT_NEWLINE .$F >
>)(T 
#FALSE () )>
><SET $I <+ 1 .$I >>>>
<:FILE$PUTC .$F #CHARACTER 93 >
<:SET_MARGIN .$MARGIN >
>DONE >
<SET PROCLIST <CONS :PT_EQUATEVAL .PROCLIST>> 

<DEFINE :PT_EQUATEVAL ( $VAL $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($VAL )<LIST FIX ANY>($F )ANY )
<PROG ($X )#DECL ( ($X )<LIST FIX ANY>)

<SET $X .$VAL >
<PROG (OLDGUY) #DECL ((OLDGUY) <LIST FIX ANY>) <SET OLDGUY .$X ><PROG (TG $X ) #DECL ((TG) FIX) <SET TG <NTH .OLDGUY 1>><SET $X <NTH .OLDGUY 2>> <COND 
(<==? .TG 1 >
<:PT_CONST .$X .$F >)
(<==? .TG 3 >
<:PT_TYPESET .$X .$F >)
(<==? .TG 2 >
<:PT_RENAMELIST .$X .$F >)>>>
>DONE >
<SET PROCLIST <CONS :PT_EQUATE .PROCLIST>> 

<DEFINE :PT_EQUATE ( $EQU $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($EQU )ANY ($F )ANY )
<PROG ()

<:PT_IDN <:EQUATE$GET_IDN .$EQU >.$F >
<:FILE$PUTS .$F " = ">
<:PT_EQUATEVAL <:EQUATE$GET_VAL .$EQU >.$F >
>DONE >
<SET PROCLIST <CONS :PT_EXCEPTION .PROCLIST>> 

<DEFINE :PT_EXCEPTION ( $X $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($X )<VECTOR ANY <VECTOR UVECTOR FIX FIX FIX>>($F )ANY )
<PROG ()

<:PT_NAME <RECORD$GET 1 .$X >.$F >
<COND (<INT$EQUAL <ARRAY$SIZE <RECORD$GET 2 .$X >>0 >
<RETURN DONE .RTN >)(T 
#FALSE () )>
<:FILE$PUTC .$F #CHARACTER 40 >
<:PT_TYPELIST <RECORD$GET 2 .$X >.$F >
<:FILE$PUTC .$F #CHARACTER 41 >
>DONE >
<SET PROCLIST <CONS :PT_EXCEPTIONLIST .PROCLIST>> 

<DEFINE :PT_EXCEPTIONLIST ( $LIST $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($LIST )<VECTOR UVECTOR FIX FIX FIX>($F )ANY )
<PROG ($HIGH )#DECL ( ($HIGH )FIX )

<SET $HIGH <ARRAY$HIGH .$LIST >>
<PROG ($I K I)#DECL (($I K I)FIX)<SET I <ARRAY$LOW .$LIST >><SET K .$HIGH ><SET $I .I><REPEAT () <COND (<L? .K .$I > <RETURN>)> 
<PROG ()
<:PT_EXCEPTION <ARRAY$FETCH .$LIST .$I >.$F >
<COND (<INT$LT .$I .$HIGH >
<:FILE$PUTS .$F ", ">)(T 
#FALSE () )>
><SET $I <+ 1 .$I >>>>
>DONE >
<SET PROCLIST <CONS :PT_RESTRICTKIND .PROCLIST>> 

<DEFINE :PT_RESTRICTKIND ( $K $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($K )<LIST FIX ANY>($F )ANY )
<PROG ($X )#DECL ( ($X )<LIST FIX ANY>)

<SET $X .$K >
<PROG (OLDGUY) #DECL ((OLDGUY) <LIST FIX ANY>) <SET OLDGUY .$X ><PROG (TG $X ) #DECL ((TG) FIX) <SET TG <NTH .OLDGUY 1>><SET $X <NTH .OLDGUY 2>> <COND 
(<==? .TG 1 >
<PROG ($MARGIN )#DECL ( ($MARGIN )FIX )
<SET $MARGIN <:GET_MARGIN >>
<:FILE$PUTS .$F "has ">
<:NEW_MARGIN .$F >
<:PT_OPERDECLLIST .$X .$F >
<:SET_MARGIN .$MARGIN >
>)
(<==? .TG 2 >
<PROG ()
<:FILE$PUTS .$F "in ">
<:PT_IDN .$X .$F >
>)
(<==? .TG 3 >
<PROG ($MARGIN )#DECL ( ($MARGIN )FIX )
<SET $MARGIN <:GET_MARGIN >>
<:FILE$PUTS .$F "in ">
<:NEW_MARGIN .$F >
<:PT_TYPESET .$X .$F >
<:SET_MARGIN .$MARGIN >
>)>>>
>DONE >
<SET PROCLIST <CONS :PT_RESTRICT .PROCLIST>> 

<DEFINE :PT_RESTRICT ( $REST $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($REST )<VECTOR ANY <LIST FIX ANY>>($F )ANY )
<PROG ()

<:PT_IDN <RECORD$GET 1 .$REST >.$F >
<:PT_RESTRICTKIND <RECORD$GET 2 .$REST >.$F >
>DONE >
<SET PROCLIST <CONS :PT_RESTRICTLIST .PROCLIST>> 

<DEFINE :PT_RESTRICTLIST ( $LIST $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($LIST )<VECTOR UVECTOR FIX FIX FIX>($F )ANY )
<PROG ($HIGH )#DECL ( ($HIGH )FIX )

<SET $HIGH <ARRAY$HIGH .$LIST >>
<PROG ($I K I)#DECL (($I K I)FIX)<SET I <ARRAY$LOW .$LIST >><SET K .$HIGH ><SET $I .I><REPEAT () <COND (<L? .K .$I > <RETURN>)> 
<PROG ()
<:PT_RESTRICT <ARRAY$FETCH .$LIST .$I >.$F >
<COND (<INT$LT .$I .$HIGH >
<PROG ()
<:FILE$PUTC .$F #CHARACTER 44 >
<:PT_NEWLINE .$F >
>)(T 
#FALSE () )>
><SET $I <+ 1 .$I >>>>
>DONE >
<SET PROCLIST <CONS :PT_BODY .PROCLIST>> 

<DEFINE :PT_BODY ( $BOD $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($BOD )<VECTOR <VECTOR UVECTOR FIX FIX FIX><VECTOR UVECTOR FIX FIX FIX>>($F )ANY )
<PROG ()

<:PT_EQUATELIST <RECORD$GET 1 .$BOD >.$F >
<COND (<INT$GT <ARRAY$SIZE <RECORD$GET 1 .$BOD >>0 >
<:PT_NEWLINE .$F >)(T 
#FALSE () )>
<:PT_STMTLIST <RECORD$GET 2 .$BOD >.$F >
>DONE >
<SET PROCLIST <CONS :PT_DECL .PROCLIST>> 

<DEFINE :PT_DECL ( $DEC $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($DEC )<VECTOR <VECTOR UVECTOR FIX FIX FIX>ANY >($F )ANY )
<PROG ()

<:PT_IDNLIST <RECORD$GET 1 .$DEC >.$F >
<:FILE$PUTS .$F ": ">
<:PT_TYPESPEC <RECORD$GET 2 .$DEC >.$F >
>DONE >
<SET PROCLIST <CONS :PT_DECLLIST .PROCLIST>> 

<DEFINE :PT_DECLLIST ( $LIST $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($LIST )<VECTOR UVECTOR FIX FIX FIX>($F )ANY )
<PROG ($HIGH )#DECL ( ($HIGH )FIX )

<SET $HIGH <ARRAY$HIGH .$LIST >>
<PROG ($I K I)#DECL (($I K I)FIX)<SET I <ARRAY$LOW .$LIST >><SET K .$HIGH ><SET $I .I><REPEAT () <COND (<L? .K .$I > <RETURN>)> 
<PROG ()
<:PT_DECL <ARRAY$FETCH .$LIST .$I >.$F >
<COND (<INT$LT .$I .$HIGH >
<:FILE$PUTS .$F ", ">)(T 
#FALSE () )>
><SET $I <+ 1 .$I >>>>
>DONE >
<SET PROCLIST <CONS :PT_APPLYSPEK .PROCLIST>> 

<DEFINE :PT_APPLYSPEK ( $SPEC $OP $VAL $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($SPEC )<VECTOR <VECTOR UVECTOR FIX FIX FIX>VECTOR ANY <VECTOR UVECTOR FIX FIX FIX><VECTOR UVECTOR FIX FIX FIX><VECTOR UVECTOR FIX FIX FIX><VECTOR UVECTOR FIX FIX FIX>>($OP )STRING ($VAL )STRING ($F )ANY )
<PROG ($MARGIN $POSN )#DECL ( ($MARGIN )FIX ($POSN )FIX )

<SET $MARGIN <:GET_MARGIN >>
<:PT_IDN <RECORD$GET 3 .$SPEC >.$F >
<:FILE$PUTS .$F " = ">
<:FILE$PUTS .$F .$OP >
<SET $POSN <INT$ADD <:FILE$COLUMN .$F >1 >>
<COND (<INT$GT <ARRAY$SIZE <RECORD$GET 4 .$SPEC >>0 >
<PROG ()
<:FILE$PUTS .$F " [">
<:PT_DECLLIST <RECORD$GET 4 .$SPEC >.$F >
<:FILE$PUTC .$F #CHARACTER 93 >
>)(T 
#FALSE () )>
<:FILE$PUTS .$F " (">
<:PT_DECLLIST <RECORD$GET 1 .$SPEC >.$F >
<:FILE$PUTC .$F #CHARACTER 41 >
<COND (<INT$GT <ARRAY$SIZE <RECORD$GET 6 .$SPEC >>0 >
<PROG ()
<:FILE$PUTC .$F #CHARACTER 32 >
<:FILE$PUTS .$F .$VAL >
<:FILE$PUTS .$F " (">
<:PT_TYPELIST <RECORD$GET 6 .$SPEC >.$F >
<:FILE$PUTC .$F #CHARACTER 41 >
>)(T 
#FALSE () )>
<COND (<INT$GT <ARRAY$SIZE <RECORD$GET 5 .$SPEC >>0 >
<PROG ()
<:FILE$PUTS .$F " signals (">
<:PT_EXCEPTIONLIST <RECORD$GET 5 .$SPEC >.$F >
<:FILE$PUTC .$F #CHARACTER 41 >
>)(T 
#FALSE () )>
<COND (<INT$GT <ARRAY$SIZE <RECORD$GET 7 .$SPEC >>0 >
<PROG ()
<:PT_NEXTLINE .$POSN .$F >
<:FILE$PUTS .$F "where ">
<:NEW_MARGIN .$F >
<:PT_RESTRICTLIST <RECORD$GET 7 .$SPEC >.$F >
<:SET_MARGIN .$MARGIN >
>)(T 
#FALSE () )>
<:FILE$PUTC .$F #CHARACTER 59 >
<:SET_MARGIN <INT$ADD .$MARGIN 4 >>
<:PT_NEWLINE .$F >
<:PT_BODY <RECORD$GET 2 .$SPEC >.$F >
<:PT_NEWLINE .$F >
<:FILE$PUTS .$F "end ">
<:PT_IDN <RECORD$GET 3 .$SPEC >.$F >
<:SET_MARGIN .$MARGIN >
>DONE >
<SET PROCLIST <CONS :PT_APPLYSPEC .PROCLIST>> 

<DEFINE :PT_APPLYSPEC ( $SPEC $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($SPEC )<VECTOR <VECTOR UVECTOR FIX FIX FIX>VECTOR ANY <VECTOR UVECTOR FIX FIX FIX><VECTOR UVECTOR FIX FIX FIX><VECTOR UVECTOR FIX FIX FIX><VECTOR UVECTOR FIX FIX FIX>>($F )ANY )
<PROG ()

<:PT_APPLYSPEK .$SPEC "oper""vals".$F >
>DONE >
<SET PROCLIST <CONS :PT_OPERDEFN .PROCLIST>> 

<DEFINE :PT_OPERDEFN ( $OP $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($OP )<LIST FIX ANY>($F )ANY )
<PROG ($X )#DECL ( ($X )<LIST FIX ANY>)

<SET $X .$OP >
<PROG (OLDGUY) #DECL ((OLDGUY) <LIST FIX ANY>) <SET OLDGUY .$X ><PROG (TG $X ) #DECL ((TG) FIX) <SET TG <NTH .OLDGUY 1>><SET $X <NTH .OLDGUY 2>> <COND 
(<==? .TG 2 >
<:PT_APPLYSPEK .$X "proc""returns".$F >)
(<==? .TG 1 >
<:PT_APPLYSPEK .$X "iter""yields".$F >)>>>
>DONE >
<SET PROCLIST <CONS :PT_OPERDEFNLIST .PROCLIST>> 

<DEFINE :PT_OPERDEFNLIST ( $LIST $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($LIST )<VECTOR UVECTOR FIX FIX FIX>($F )ANY )
<PROG ($HIGH )#DECL ( ($HIGH )FIX )

<SET $HIGH <ARRAY$HIGH .$LIST >>
<PROG ($I K I)#DECL (($I K I)FIX)<SET I <ARRAY$LOW .$LIST >><SET K .$HIGH ><SET $I .I><REPEAT () <COND (<L? .K .$I > <RETURN>)> 
<PROG ()
<:PT_OPERDEFN <ARRAY$FETCH .$LIST .$I >.$F >
<:FILE$PUTC .$F #CHARACTER 59 >
<COND (<INT$LT .$I .$HIGH >
<PROG ()
<:PT_NEWLINE .$F >
<:PT_NEWLINE .$F >
>)(T 
#FALSE () )>
><SET $I <+ 1 .$I >>>>
>DONE >
<SET PROCLIST <CONS :PT_CLUSPEC .PROCLIST>> 

<DEFINE :PT_CLUSPEC ( $SPEC $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($SPEC )<VECTOR <VECTOR UVECTOR FIX FIX FIX><VECTOR UVECTOR FIX FIX FIX>ANY <VECTOR UVECTOR FIX FIX FIX><VECTOR UVECTOR FIX FIX FIX><VECTOR UVECTOR FIX FIX FIX>>($F )ANY )
<PROG ($MARGIN $OPS $HIGH $POSN )#DECL ( ($MARGIN )FIX ($OPS )<VECTOR UVECTOR FIX FIX FIX>($HIGH )FIX ($POSN )FIX )

<SET $MARGIN <:GET_MARGIN >>
<SET $OPS <RECORD$GET 4 .$SPEC >>
<SET $HIGH <ARRAY$HIGH .$OPS >>
<:PT_IDN <RECORD$GET 3 .$SPEC >.$F >
<:FILE$PUTS .$F " = cluster ">
<SET $POSN <:FILE$COLUMN .$F >>
<COND (<INT$GT <ARRAY$SIZE <RECORD$GET 5 .$SPEC >>0 >
<PROG ()
<:FILE$PUTC .$F #CHARACTER 91 >
<:PT_DECLLIST <RECORD$GET 5 .$SPEC >.$F >
<:FILE$PUTS .$F "] ">
>)(T 
#FALSE () )>
<:FILE$PUTS .$F "is ">
<:NEW_MARGIN .$F >
<PROG ($I K I)#DECL (($I K I)FIX)<SET I <ARRAY$LOW .$OPS >><SET K .$HIGH ><SET $I .I><REPEAT () <COND (<L? .K .$I > <RETURN>)> 
<PROG ()
<:PT_IDN <ARRAY$FETCH .$OPS .$I >.$F >
<COND (<INT$LT .$I .$HIGH >
<PROG ()
<:FILE$PUTC .$F #CHARACTER 44 >
<:PT_NEWLINE .$F >
>)(T 
#FALSE () )>
><SET $I <+ 1 .$I >>>>
<COND (<INT$GT <ARRAY$SIZE <RECORD$GET 6 .$SPEC >>0 >
<PROG ()
<:PT_NEXTLINE .$POSN .$F >
<:FILE$PUTS .$F "where ">
<:NEW_MARGIN .$F >
<:PT_RESTRICTLIST <RECORD$GET 6 .$SPEC >.$F >
>)(T 
#FALSE () )>
<:FILE$PUTC .$F #CHARACTER 59 >
<:SET_MARGIN .$MARGIN >
<:PT_NEWLINE .$F >
<:PT_NEWLINE .$F >
<:PT_EQUATELIST <RECORD$GET 2 .$SPEC >.$F >
<COND (<INT$GT <ARRAY$SIZE <RECORD$GET 2 .$SPEC >>0 >
<PROG ()
<:PT_NEWLINE .$F >
<:PT_NEWLINE .$F >
>)(T 
#FALSE () )>
<:PT_OPERDEFNLIST <RECORD$GET 1 .$SPEC >.$F >
<:PT_NEWLINE .$F >
<:PT_NEWLINE .$F >
<:FILE$PUTS .$F "end ">
<:PT_IDN <RECORD$GET 3 .$SPEC >.$F >
>DONE >
<SET PROCLIST <CONS :PT_DEFINITION .PROCLIST>> 

<DEFINE :PT_DEFINITION ( $DEF $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($DEF )<LIST FIX ANY>($F )ANY )
<PROG ($X )#DECL ( ($X )<LIST FIX ANY>)

<SET $X .$DEF >
<PROG (OLDGUY) #DECL ((OLDGUY) <LIST FIX ANY>) <SET OLDGUY .$X ><PROG (TG $X ) #DECL ((TG) FIX) <SET TG <NTH .OLDGUY 1>><SET $X <NTH .OLDGUY 2>> <COND 
(<==? .TG 2 >
<:PT_EQUATELIST .$X .$F >)
(<==? .TG 4 >
<PROG ()
<:PT_APPLYSPEK .$X "proc""returns".$F >
<:FILE$PUTC .$F #CHARACTER 59 >
>)
(<==? .TG 3 >
<PROG ()
<:PT_APPLYSPEK .$X "iter""yields".$F >
<:FILE$PUTC .$F #CHARACTER 59 >
>)
(<==? .TG 1 >
<PROG ()
<:PT_CLUSPEC .$X .$F >
<:FILE$PUTC .$F #CHARACTER 59 >
>)>>>
>DONE >
<SET PROCLIST <CONS :PT_DECLINIT .PROCLIST>> 

<DEFINE :PT_DECLINIT ( $DEC $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($DEC )<VECTOR <VECTOR UVECTOR FIX FIX FIX>ANY >($F )ANY )
<PROG ()

<:PT_DECLLIST <RECORD$GET 1 .$DEC >.$F >
<:FILE$PUTS .$F " := ">
<:PT_EXPR <RECORD$GET 2 .$DEC >.$F >
>DONE >
<SET PROCLIST <CONS :PT_INVOKE .PROCLIST>> 

<DEFINE :PT_INVOKE ( $INV $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($INV )<VECTOR ANY <VECTOR UVECTOR FIX FIX FIX><LIST FIX ANY>>($F )ANY )
<PROG ($TAB )#DECL ( ($TAB )<LIST FIX ANY>)

<:PT_EXPR <RECORD$GET 1 .$INV >.$F >
<:FILE$PUTC .$F #CHARACTER 40 >
<:PT_EXPRLIST <RECORD$GET 2 .$INV >.$F >
<:FILE$PUTC .$F #CHARACTER 41 >
<SET $TAB <RECORD$GET 3 .$INV >>
<PROG (OLDGUY) #DECL ((OLDGUY) <LIST FIX ANY>) <SET OLDGUY .$TAB ><PROG (TG $TAB ) #DECL ((TG) FIX) <SET TG <NTH .OLDGUY 1>><SET $TAB <NTH .OLDGUY 2>> <COND 
(<==? .TG 1 >
<PROG ()
<:FILE$PUTC .$F #CHARACTER 33 >
<:PT_IDN .$TAB .$F >
>)
(<==? .TG 2 >
<PROG ()
<:FILE$PUTC .$F #CHARACTER 33 >
<:PT_RENAMELIST .$TAB .$F >
>)(T 
#FALSE () )>>>
>DONE >
<SET PROCLIST <CONS :PT_ASSN .PROCLIST>> 

<DEFINE :PT_ASSN ( $ASN $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($ASN )<VECTOR <VECTOR UVECTOR FIX FIX FIX><VECTOR UVECTOR FIX FIX FIX>>($F )ANY )
<PROG ()

<:PT_IDNLIST <RECORD$GET 1 .$ASN >.$F >
<:FILE$PUTS .$F " := ">
<:PT_EXPRLIST <RECORD$GET 2 .$ASN >.$F >
>DONE >
<SET PROCLIST <CONS :PT_SUGARASSN .PROCLIST>> 

<DEFINE :PT_SUGARASSN ( $ASN $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($ASN )<VECTOR ANY ANY >($F )ANY )
<PROG ()

<:PT_EXPR <RECORD$GET 1 .$ASN >.$F >
<:FILE$PUTS .$F " := ">
<:PT_EXPR <RECORD$GET 2 .$ASN >.$F >
>DONE >
<SET PROCLIST <CONS :PT_WHILESTMT .PROCLIST>> 

<DEFINE :PT_WHILESTMT ( $WS $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($WS )<VECTOR VECTOR ANY >($F )ANY )
<PROG ($MARGIN )#DECL ( ($MARGIN )FIX )

<SET $MARGIN <:GET_MARGIN >>
<:FILE$PUTS .$F "while ">
<:PT_EXPR <RECORD$GET 2 .$WS >.$F >
<:FILE$PUTS .$F " do">
<:SET_MARGIN <INT$ADD .$MARGIN 4 >>
<:PT_NEWLINE .$F >
<:PT_BODY <RECORD$GET 1 .$WS >.$F >
<:PT_NEWLINE .$F >
<:FILE$PUTS .$F "end">
<:SET_MARGIN .$MARGIN >
>DONE >
<SET PROCLIST <CONS :PT_FORVARS .PROCLIST>> 

<DEFINE :PT_FORVARS ( $VARS $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($VARS )<LIST FIX ANY>($F )ANY )
<PROG ($X )#DECL ( ($X )<LIST FIX ANY>)

<SET $X .$VARS >
<PROG (OLDGUY) #DECL ((OLDGUY) <LIST FIX ANY>) <SET OLDGUY .$X ><PROG (TG $X ) #DECL ((TG) FIX) <SET TG <NTH .OLDGUY 1>><SET $X <NTH .OLDGUY 2>> <COND 
(<==? .TG 2 >
<:PT_IDNLIST .$X .$F >)
(<==? .TG 1 >
<:PT_DECLLIST .$X .$F >)>>>
>DONE >
<SET PROCLIST <CONS :PT_FORSTMT .PROCLIST>> 

<DEFINE :PT_FORSTMT ( $FS $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($FS )<VECTOR VECTOR VECTOR <LIST FIX ANY>>($F )ANY )
<PROG ($MARGIN )#DECL ( ($MARGIN )FIX )

<SET $MARGIN <:GET_MARGIN >>
<:FILE$PUTS .$F "for ">
<:PT_FORVARS <RECORD$GET 3 .$FS >.$F >
<:FILE$PUTS .$F " in ">
<:PT_INVOKE <RECORD$GET 2 .$FS >.$F >
<:FILE$PUTS .$F " do">
<:SET_MARGIN <INT$ADD .$MARGIN 4 >>
<:PT_NEWLINE .$F >
<:PT_BODY <RECORD$GET 1 .$FS >.$F >
<:PT_NEWLINE .$F >
<:FILE$PUTS .$F "end">
<:SET_MARGIN .$MARGIN >
>DONE >
<SET PROCLIST <CONS :PT_IFARM .PROCLIST>> 

<DEFINE :PT_IFARM ( $ARM $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($ARM )<VECTOR VECTOR ANY >($F )ANY )
<PROG ($MARGIN )#DECL ( ($MARGIN )FIX )

<SET $MARGIN <:GET_MARGIN >>
<:NEW_MARGIN .$F >
<:PT_EXPR <RECORD$GET 2 .$ARM >.$F >
<:PT_NEWLINE .$F >
<:FILE$PUTS .$F "then ">
<:NEW_MARGIN .$F >
<:PT_BODY <RECORD$GET 1 .$ARM >.$F >
<:SET_MARGIN .$MARGIN >
>DONE >
<SET PROCLIST <CONS :PT_IFARMLIST .PROCLIST>> 

<DEFINE :PT_IFARMLIST ( $LIST $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($LIST )<VECTOR UVECTOR FIX FIX FIX>($F )ANY )
<PROG ($MARGIN $HIGH $LOW )#DECL ( ($MARGIN )FIX ($HIGH )FIX ($LOW )FIX )

<SET $MARGIN <:GET_MARGIN >>
<SET $HIGH <ARRAY$HIGH .$LIST >>
<SET $LOW <ARRAY$LOW .$LIST >>
<:FILE$PUTS .$F "if ">
<:NEW_MARGIN .$F >
<:PT_IFARM <ARRAY$FETCH .$LIST .$LOW >.$F >
<PROG ($I K I)#DECL (($I K I)FIX)<SET I <INT$ADD .$LOW 1 >><SET K .$HIGH ><SET $I .I><REPEAT () <COND (<L? .K .$I > <RETURN>)> 
<PROG ()
<:PT_NEWLINE .$F >
<:FILE$PUTS .$F "elseif ">
<:PT_IFARM <ARRAY$FETCH .$LIST .$I >.$F >
><SET $I <+ 1 .$I >>>>
<:SET_MARGIN .$MARGIN >
>DONE >
<SET PROCLIST <CONS :PT_IFSTMT .PROCLIST>> 

<DEFINE :PT_IFSTMT ( $IFS $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($IFS )<VECTOR <VECTOR UVECTOR FIX FIX FIX><LIST FIX ANY>>($F )ANY )
<PROG ($MBOD )#DECL ( ($MBOD )<LIST FIX ANY>)

<:PT_IFARMLIST <RECORD$GET 1 .$IFS >.$F >
<SET $MBOD <RECORD$GET 2 .$IFS >>
<PROG (OLDGUY) #DECL ((OLDGUY) <LIST FIX ANY>) <SET OLDGUY .$MBOD ><PROG (TG $MBOD ) #DECL ((TG) FIX) <SET TG <NTH .OLDGUY 1>><SET $MBOD <NTH .OLDGUY 2>> <COND 
(<==? .TG 1 >
<PROG ($MARGIN )#DECL ( ($MARGIN )FIX )
<SET $MARGIN <:GET_MARGIN >>
<:PT_NEWLINE .$F >
<:FILE$PUTS .$F "   else ">
<:NEW_MARGIN .$F >
<:PT_BODY .$MBOD .$F >
<:SET_MARGIN .$MARGIN >
>)
(<==? .TG 2 >
#FALSE () )>>>
<:PT_NEWLINE .$F >
<:FILE$PUTS .$F "   end">
>DONE >
<SET PROCLIST <CONS :PT_TAGARM .PROCLIST>> 

<DEFINE :PT_TAGARM ( $ARM $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($ARM )<VECTOR VECTOR <VECTOR UVECTOR FIX FIX FIX><LIST FIX ANY>>($F )ANY )
<PROG ($MARGIN $DEC )#DECL ( ($MARGIN )FIX ($DEC )<LIST FIX ANY>)

<SET $MARGIN <:GET_MARGIN >>
<:FILE$PUTS .$F "tag ">
<:PT_NAMELIST <RECORD$GET 2 .$ARM >.$F >
<SET $DEC <RECORD$GET 3 .$ARM >>
<PROG (OLDGUY) #DECL ((OLDGUY) <LIST FIX ANY>) <SET OLDGUY .$DEC ><PROG (TG $DEC ) #DECL ((TG) FIX) <SET TG <NTH .OLDGUY 1>><SET $DEC <NTH .OLDGUY 2>> <COND 
(<==? .TG 1 >
<PROG ()
<:FILE$PUTS .$F " (">
<:PT_DECL .$DEC .$F >
<:FILE$PUTC .$F #CHARACTER 41 >
>)
(<==? .TG 2 >
#FALSE () )>>>
<:FILE$PUTC .$F #CHARACTER 58 >
<:SET_MARGIN <INT$ADD .$MARGIN 4 >>
<:PT_NEWLINE .$F >
<:PT_BODY <RECORD$GET 1 .$ARM >.$F >
<:SET_MARGIN .$MARGIN >
>DONE >
<SET PROCLIST <CONS :PT_TAGARMLIST .PROCLIST>> 

<DEFINE :PT_TAGARMLIST ( $LIST $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($LIST )<VECTOR UVECTOR FIX FIX FIX>($F )ANY )
<PROG ($HIGH )#DECL ( ($HIGH )FIX )

<SET $HIGH <ARRAY$HIGH .$LIST >>
<PROG ($I K I)#DECL (($I K I)FIX)<SET I <ARRAY$LOW .$LIST >><SET K .$HIGH ><SET $I .I><REPEAT () <COND (<L? .K .$I > <RETURN>)> 
<PROG ()
<:PT_TAGARM <ARRAY$FETCH .$LIST .$I >.$F >
<COND (<INT$LT .$I .$HIGH >
<:PT_NEWLINE .$F >)(T 
#FALSE () )>
><SET $I <+ 1 .$I >>>>
>DONE >
<SET PROCLIST <CONS :PT_TAGSTMT .PROCLIST>> 

<DEFINE :PT_TAGSTMT ( $TS $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($TS )<VECTOR <VECTOR UVECTOR FIX FIX FIX>ANY <LIST FIX ANY>>($F )ANY )
<PROG ($MARGIN $MBOD )#DECL ( ($MARGIN )FIX ($MBOD )<LIST FIX ANY>)

<SET $MARGIN <:GET_MARGIN >>
<:FILE$PUTS .$F "tagcase ">
<:PT_EXPR <RECORD$GET 2 .$TS >.$F >
<:SET_MARGIN <INT$ADD .$MARGIN 4 >>
<:PT_NEWLINE .$F >
<:PT_TAGARMLIST <RECORD$GET 1 .$TS >.$F >
<SET $MBOD <RECORD$GET 3 .$TS >>
<PROG (OLDGUY) #DECL ((OLDGUY) <LIST FIX ANY>) <SET OLDGUY .$MBOD ><PROG (TG $MBOD ) #DECL ((TG) FIX) <SET TG <NTH .OLDGUY 1>><SET $MBOD <NTH .OLDGUY 2>> <COND 
(<==? .TG 1 >
<PROG ()
<:PT_NEWLINE .$F >
<:FILE$PUTS .$F "others:">
<:SET_MARGIN <INT$ADD .$MARGIN <INT$MUL 2 4 >>>
<:PT_NEWLINE .$F >
<:PT_BODY .$MBOD .$F >
>)
(<==? .TG 2 >
#FALSE () )>>>
<:SET_MARGIN .$MARGIN >
<:PT_NEXTLINE <INT$ADD .$MARGIN 4 >.$F >
<:FILE$PUTS .$F "end">
>DONE >
<SET PROCLIST <CONS :PT_ERROR .PROCLIST>> 

<DEFINE :PT_ERROR ( $ERR $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($ERR )<VECTOR <VECTOR UVECTOR FIX FIX FIX>ANY >($F )ANY )
<PROG ($ARGS )#DECL ( ($ARGS )<VECTOR UVECTOR FIX FIX FIX>)

<SET $ARGS <RECORD$GET 1 .$ERR >>
<:PT_NAME <RECORD$GET 2 .$ERR >.$F >
<COND (<INT$EQUAL <ARRAY$SIZE .$ARGS >0 >
<RETURN DONE .RTN >)(T 
#FALSE () )>
<:FILE$PUTC .$F #CHARACTER 40 >
<:PT_EXPRLIST .$ARGS .$F >
<:FILE$PUTC .$F #CHARACTER 41 >
>DONE >
<SET PROCLIST <CONS :PT_WHENDECL .PROCLIST>> 

<DEFINE :PT_WHENDECL ( $DEC $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($DEC )<LIST FIX ANY>($F )ANY )
<PROG ($X )#DECL ( ($X )<LIST FIX ANY>)

<SET $X .$DEC >
<PROG (OLDGUY) #DECL ((OLDGUY) <LIST FIX ANY>) <SET OLDGUY .$X ><PROG (TG $X ) #DECL ((TG) FIX) <SET TG <NTH .OLDGUY 1>><SET $X <NTH .OLDGUY 2>> <COND 
(<==? .TG 1 >
<PROG ()
<:FILE$PUTC .$F #CHARACTER 40 >
<:PT_DECLLIST .$X .$F >
<:FILE$PUTC .$F #CHARACTER 41 >
>)
(<==? .TG 3 >
<:FILE$PUTS .$F "(*)">)
(<==? .TG 2 >
#FALSE () )>>>
>DONE >
<SET PROCLIST <CONS :PT_HANDLER .PROCLIST>> 

<DEFINE :PT_HANDLER ( $H $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($H )<VECTOR VECTOR <VECTOR UVECTOR FIX FIX FIX><LIST FIX ANY>>($F )ANY )
<PROG ($MARGIN )#DECL ( ($MARGIN )FIX )

<SET $MARGIN <:GET_MARGIN >>
<:FILE$PUTS .$F "when ">
<:NEW_MARGIN .$F >
<:PT_NAMELIST <RECORD$GET 2 .$H >.$F >
<:PT_WHENDECL <RECORD$GET 3 .$H >.$F >
<:FILE$PUTC .$F #CHARACTER 58 >
<:SET_MARGIN <INT$ADD .$MARGIN 4 >>
<:PT_NEWLINE .$F >
<:PT_BODY <RECORD$GET 1 .$H >.$F >
<:SET_MARGIN .$MARGIN >
>DONE >
<SET PROCLIST <CONS :PT_HANDLERLIST .PROCLIST>> 

<DEFINE :PT_HANDLERLIST ( $LIST $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($LIST )<VECTOR UVECTOR FIX FIX FIX>($F )ANY )
<PROG ($HIGH )#DECL ( ($HIGH )FIX )

<SET $HIGH <ARRAY$HIGH .$LIST >>
<PROG ($I K I)#DECL (($I K I)FIX)<SET I <ARRAY$LOW .$LIST >><SET K .$HIGH ><SET $I .I><REPEAT () <COND (<L? .K .$I > <RETURN>)> 
<PROG ()
<:PT_HANDLER <ARRAY$FETCH .$LIST .$I >.$F >
<COND (<INT$LT .$I .$HIGH >
<:PT_NEWLINE .$F >)(T 
#FALSE () )>
><SET $I <+ 1 .$I >>>>
>DONE >
<SET PROCLIST <CONS :PT_OTHERSARM .PROCLIST>> 

<DEFINE :PT_OTHERSARM ( $ARM $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($ARM )<VECTOR VECTOR <LIST FIX ANY>>($F )ANY )
<PROG ($MARGIN $DEC )#DECL ( ($MARGIN )FIX ($DEC )<LIST FIX ANY>)

<SET $MARGIN <:GET_MARGIN >>
<:FILE$PUTS .$F "others">
<SET $DEC <RECORD$GET 2 .$ARM >>
<PROG (OLDGUY) #DECL ((OLDGUY) <LIST FIX ANY>) <SET OLDGUY .$DEC ><PROG (TG $DEC ) #DECL ((TG) FIX) <SET TG <NTH .OLDGUY 1>><SET $DEC <NTH .OLDGUY 2>> <COND 
(<==? .TG 1 >
<PROG ()
<:FILE$PUTS .$F " (">
<:PT_DECL .$DEC .$F >
<:FILE$PUTC .$F #CHARACTER 41 >
>)
(<==? .TG 2 >
#FALSE () )>>>
<:FILE$PUTC .$F #CHARACTER 58 >
<:SET_MARGIN <INT$ADD .$MARGIN 4 >>
<:PT_NEWLINE .$F >
<:PT_BODY <RECORD$GET 1 .$ARM >.$F >
<:SET_MARGIN .$MARGIN >
>DONE >
<SET PROCLIST <CONS :PT_EXCEPTSTMT .PROCLIST>> 

<DEFINE :PT_EXCEPTSTMT ( $EX $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($EX )<VECTOR <VECTOR UVECTOR FIX FIX FIX><LIST FIX ANY>ANY >($F )ANY )
<PROG ($MARGIN $MOTH )#DECL ( ($MARGIN )FIX ($MOTH )<LIST FIX ANY>)

<SET $MARGIN <:GET_MARGIN >>
<:PT_STMT <RECORD$GET 3 .$EX >.$F >
<:FILE$PUTC .$F #CHARACTER 59 >
<:PT_NEXTLINE <INT$ADD .$MARGIN 4 >.$F >
<:FILE$PUTS .$F "except">
<:SET_MARGIN <INT$ADD <INT$ADD .$MARGIN 4 >3 >>
<:PT_NEWLINE .$F >
<:PT_HANDLERLIST <RECORD$GET 1 .$EX >.$F >
<SET $MOTH <RECORD$GET 2 .$EX >>
<PROG (OLDGUY) #DECL ((OLDGUY) <LIST FIX ANY>) <SET OLDGUY .$MOTH ><PROG (TG $MOTH ) #DECL ((TG) FIX) <SET TG <NTH .OLDGUY 1>><SET $MOTH <NTH .OLDGUY 2>> <COND 
(<==? .TG 1 >
<PROG ()
<:PT_NEWLINE .$F >
<:PT_OTHERSARM .$MOTH .$F >
>)
(<==? .TG 2 >
#FALSE () )>>>
<:PT_NEWLINE .$F >
<:FILE$PUTS .$F "end">
<:SET_MARGIN .$MARGIN >
>DONE >
<SET PROCLIST <CONS :PT_STMT .PROCLIST>> 

<DEFINE :PT_STMT ( $S $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($S )ANY ($F )ANY )
<PROG ()

<:PT_STMTABS <:STMT$GET_ABS .$S >.$F >
>DONE >
<SET PROCLIST <CONS :PT_STMTABS .PROCLIST>> 

<DEFINE :PT_STMTABS ( $SA $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($SA )<LIST FIX ANY>($F )ANY )
<PROG ($X )#DECL ( ($X )<LIST FIX ANY>)

<SET $X .$SA >
<PROG (OLDGUY) #DECL ((OLDGUY) <LIST FIX ANY>) <SET OLDGUY .$X ><PROG (TG $X ) #DECL ((TG) FIX) <SET TG <NTH .OLDGUY 1>><SET $X <NTH .OLDGUY 2>> <COND 
(<==? .TG 5 >
<:PT_DECL .$X .$F >)
(<==? .TG 6 >
<:PT_DECLINIT .$X .$F >)
(<==? .TG 1 >
<:PT_ASSN .$X .$F >)
(<==? .TG 13 >
<:PT_SUGARASSN .$X .$F >)
(<==? .TG 10 >
<:PT_INVOKE .$X .$F >)
(<==? .TG 15 >
<:PT_WHILESTMT .$X .$F >)
(<==? .TG 8 >
<:PT_FORSTMT .$X .$F >)
(<==? .TG 9 >
<:PT_IFSTMT .$X .$F >)
(<==? .TG 14 >
<:PT_TAGSTMT .$X .$F >)
(<==? .TG 11 >
<PROG ()
<:FILE$PUTS .$F "return">
<COND (<INT$EQUAL <ARRAY$SIZE .$X >0 >
<RETURN DONE .RTN >)(T 
#FALSE () )>
<:FILE$PUTC .$F #CHARACTER 40 >
<:PT_EXPRLIST .$X .$F >
<:FILE$PUTC .$F #CHARACTER 41 >
>)
(<==? .TG 16 >
<PROG ()
<:FILE$PUTS .$F "yield">
<COND (<INT$EQUAL <ARRAY$SIZE .$X >0 >
<RETURN DONE .RTN >)(T 
#FALSE () )>
<:FILE$PUTC .$F #CHARACTER 40 >
<:PT_EXPRLIST .$X .$F >
<:FILE$PUTC .$F #CHARACTER 41 >
>)
(<==? .TG 12 >
<PROG ()
<:FILE$PUTS .$F "signal ">
<:PT_ERROR .$X .$F >
>)
(<==? .TG 4 >
<:FILE$PUTS .$F "break">)
(<==? .TG 3 >
<PROG ($MARGIN )#DECL ( ($MARGIN )FIX )
<SET $MARGIN <:GET_MARGIN >>
<:FILE$PUTS .$F "begin">
<:SET_MARGIN <INT$ADD .$MARGIN 4 >>
<:PT_NEWLINE .$F >
<:PT_BODY .$X .$F >
<:SET_MARGIN .$MARGIN >
<:PT_NEWLINE .$F >
<:FILE$PUTS .$F "end">
>)
(<==? .TG 7 >
<:PT_EXCEPTSTMT .$X .$F >)
(<==? .TG 2 >
<:FILE$PUTS .$F "?stmt?">)>>>
>DONE >
<SET PROCLIST <CONS :PT_APPLYTYP .PROCLIST>> 

<DEFINE :PT_APPLYTYP ( $TYP $OP $VAL $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($TYP )<VECTOR <VECTOR UVECTOR FIX FIX FIX><VECTOR UVECTOR FIX FIX FIX><VECTOR UVECTOR FIX FIX FIX>>($OP )STRING ($VAL )STRING ($F )ANY )
<PROG ()

<:FILE$PUTS .$F .$OP >
<:FILE$PUTS .$F " (">
<:PT_TYPELIST <RECORD$GET 1 .$TYP >.$F >
<:FILE$PUTC .$F #CHARACTER 41 >
<COND (<INT$GT <ARRAY$SIZE <RECORD$GET 3 .$TYP >>0 >
<PROG ()
<:FILE$PUTC .$F #CHARACTER 32 >
<:FILE$PUTS .$F .$VAL >
<:FILE$PUTS .$F " (">
<:PT_TYPELIST <RECORD$GET 3 .$TYP >.$F >
<:FILE$PUTC .$F #CHARACTER 41 >
>)(T 
#FALSE () )>
<COND (<INT$GT <ARRAY$SIZE <RECORD$GET 2 .$TYP >>0 >
<PROG ()
<:FILE$PUTS .$F " signals (">
<:PT_EXCEPTIONLIST <RECORD$GET 2 .$TYP >.$F >
<:FILE$PUTC .$F #CHARACTER 41 >
>)(T 
#FALSE () )>
>DONE >
<SET PROCLIST <CONS :PT_APPLYTYPE .PROCLIST>> 

<DEFINE :PT_APPLYTYPE ( $TYP $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($TYP )<VECTOR <VECTOR UVECTOR FIX FIX FIX><VECTOR UVECTOR FIX FIX FIX><VECTOR UVECTOR FIX FIX FIX>>($F )ANY )
<PROG ()

<:PT_APPLYTYP .$TYP "opertype""vals".$F >
>DONE >
<SET PROCLIST <CONS :PT_ATYPE .PROCLIST>> 

<DEFINE :PT_ATYPE ( $TYP $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($TYP )<VECTOR ANY <VECTOR UVECTOR FIX FIX FIX>>($F )ANY )
<PROG ()

<:PT_IDN <RECORD$GET 1 .$TYP >.$F >
<:PT_CONSTLIST <RECORD$GET 2 .$TYP >.$F >
>DONE >
<SET PROCLIST <CONS :PT_DUTYPE .PROCLIST>> 

<DEFINE :PT_DUTYPE ( $TYP $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($TYP )<VECTOR ANY <VECTOR UVECTOR FIX FIX FIX>>($F )ANY )
<PROG ()

<:FILE$PUTS .$F <:DU$GET_UNIQUE <RECORD$GET 1 .$TYP >>>
<:PT_CONSTLIST <RECORD$GET 2 .$TYP >.$F >
>DONE >
<SET PROCLIST <CONS :PT_FIELDSPEK .PROCLIST>> 

<DEFINE :PT_FIELDSPEK ( $SPEC $SPACE $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($SPEC )<VECTOR ANY ANY >($SPACE )FIX ($F )ANY )
<PROG ()

<:PT_NAME <RECORD$GET 1 .$SPEC >.$F >
<:FILE$PUTC .$F #CHARACTER 58 >
<PROG ($I K I)#DECL (($I K I)FIX)<SET I <:FILE$COLUMN .$F >><SET K .$SPACE ><SET $I .I><REPEAT () <COND (<L? .K .$I > <RETURN>)> 
<PROG ()
<:FILE$PUTC .$F #CHARACTER 32 >
><SET $I <+ 1 .$I >>>>
<:PT_TYPESPEC <RECORD$GET 2 .$SPEC >.$F >
>DONE >
<SET PROCLIST <CONS :PT_FIELDSPEC .PROCLIST>> 

<DEFINE :PT_FIELDSPEC ( $SPEC $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($SPEC )<VECTOR ANY ANY >($F )ANY )
<PROG ()

<:PT_FIELDSPEK .$SPEC <INT$ADD <STRING$SIZE <:NAME$GET_STR <RECORD$GET 1 .$SPEC >>>1 >.$F >
>DONE >
<SET PROCLIST <CONS :PT_SELTYPE .PROCLIST>> 

<DEFINE :PT_SELTYPE ( $LIST $MOD $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($LIST )<VECTOR UVECTOR FIX FIX FIX>($MOD )STRING ($F )ANY )
<PROG ($MARGIN $HIGH $SPACE )#DECL ( ($MARGIN )FIX ($HIGH )FIX ($SPACE )FIX )

<SET $MARGIN <:GET_MARGIN >>
<SET $HIGH <ARRAY$HIGH .$LIST >>
<SET $SPACE 0 >
<:FILE$PUTS .$F .$MOD >
<:FILE$PUTC .$F #CHARACTER 91 >
<:NEW_MARGIN .$F >
<PROG ($I K I)#DECL (($I K I)FIX)<SET I <ARRAY$LOW .$LIST >><SET K .$HIGH ><SET $I .I><REPEAT () <COND (<L? .K .$I > <RETURN>)> 
<PROG ($SIZE )#DECL ( ($SIZE )FIX )
<SET $SIZE <STRING$SIZE <:NAME$GET_STR <RECORD$GET 1 <ARRAY$FETCH .$LIST .$I >>>>>
<COND (<INT$GT .$SIZE .$SPACE >
<SET $SPACE .$SIZE >)(T 
#FALSE () )>
><SET $I <+ 1 .$I >>>>
<SET $SPACE <INT$ADD <INT$ADD .$SPACE <:FILE$COLUMN .$F >>1 >>
<PROG ($I K I)#DECL (($I K I)FIX)<SET I <ARRAY$LOW .$LIST >><SET K .$HIGH ><SET $I .I><REPEAT () <COND (<L? .K .$I > <RETURN>)> 
<PROG ()
<:PT_FIELDSPEK <ARRAY$FETCH .$LIST .$I >.$SPACE .$F >
<COND (<INT$LT .$I .$HIGH >
<PROG ()
<:FILE$PUTC .$F #CHARACTER 44 >
<:PT_NEWLINE .$F >
>)(T 
#FALSE () )>
><SET $I <+ 1 .$I >>>>
<:FILE$PUTC .$F #CHARACTER 93 >
<:SET_MARGIN .$MARGIN >
>DONE >
<SET PROCLIST <CONS :PT_FIELDSPECLIST .PROCLIST>> 

<DEFINE :PT_FIELDSPECLIST ( $LIST $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($LIST )<VECTOR UVECTOR FIX FIX FIX>($F )ANY )
<PROG ()

<:PT_SELTYPE .$LIST "select".$F >
>DONE >
<SET PROCLIST <CONS :PT_OTHERTYPE .PROCLIST>> 

<DEFINE :PT_OTHERTYPE ( $OT $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($OT )<LIST FIX ANY>($F )ANY )
<PROG ($X )#DECL ( ($X )<LIST FIX ANY>)

<SET $X .$OT >
<PROG (OLDGUY) #DECL ((OLDGUY) <LIST FIX ANY>) <SET OLDGUY .$X ><PROG (TG $X ) #DECL ((TG) FIX) <SET TG <NTH .OLDGUY 1>><SET $X <NTH .OLDGUY 2>> <COND 
(<==? .TG 1 >
<PROG ()
<:FILE$PUTS .$F "type_of(">
<:PT_APPLY .$X .$F >
<:FILE$PUTC .$F #CHARACTER 41 >
>)
(<==? .TG 2 >
<PROG ()
<:FILE$PUTS .$F "type_of(">
<:PT_CLUSTEROP .$X .$F >
<:FILE$PUTC .$F #CHARACTER 41 >
>)
(<==? .TG 3 >
<PROG ()
<:FILE$PUTS .$F "return_type(">
<:PT_TYPESPEC .$X .$F >
<:FILE$PUTC .$F #CHARACTER 41 >
>)>>>
>DONE >
<SET PROCLIST <CONS :PT_TYPESPEC .PROCLIST>> 

<DEFINE :PT_TYPESPEC ( $TYP $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($TYP )ANY ($F )ANY )
<PROG ()

<:PT_TYPEABS <:TYPESPEC$GET_PRINT .$TYP >.$F >
>DONE >
<SET PROCLIST <CONS :PT_TYPEABS .PROCLIST>> 

<DEFINE :PT_TYPEABS ( $TA $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($TA )<LIST FIX ANY>($F )ANY )
<PROG ($X )#DECL ( ($X )<LIST FIX ANY>)

<SET $X .$TA >
<PROG (OLDGUY) #DECL ((OLDGUY) <LIST FIX ANY>) <SET OLDGUY .$X ><PROG (TG $X ) #DECL ((TG) FIX) <SET TG <NTH .OLDGUY 1>><SET $X <NTH .OLDGUY 2>> <COND 
(<==? .TG 4 >
<:FILE$PUTS .$F "bool">)
(<==? .TG 8 >
<:FILE$PUTS .$F "int">)
(<==? .TG 17 >
<:FILE$PUTS .$F "string">)
(<==? .TG 5 >
<:FILE$PUTS .$F "char">)
(<==? .TG 10 >
<:FILE$PUTS .$F "null">)
(<==? .TG 2 >
<:FILE$PUTS .$F "any">)
(<==? .TG 18 >
<:FILE$PUTS .$F "type">)
(<==? .TG 6 >
<:FILE$PUTS .$F "cvt">)
(<==? .TG 16 >
<:FILE$PUTS .$F "rep".$F >)
(<==? .TG 15 >
<:PT_SELTYPE .$X "record".$F >)
(<==? .TG 11 >
<:PT_SELTYPE .$X "oneof".$F >)
(<==? .TG 3 >
<PROG ()
<:FILE$PUTS .$F "array[">
<:PT_TYPESPEC .$X .$F >
<:FILE$PUTC .$F #CHARACTER 93 >
>)
(<==? .TG 14 >
<:PT_APPLYTYP .$X "proctype""returns".$F >)
(<==? .TG 9 >
<:PT_APPLYTYP .$X "itertype""yields".$F >)
(<==? .TG 1 >
<:PT_ATYPE .$X .$F >)
(<==? .TG 7 >
<:PT_DUTYPE .$X .$F >)
(<==? .TG 13 >
<:PT_IDN .$X .$F >)
(<==? .TG 12 >
<:PT_OTHERTYPE .$X .$F >)
(<==? .TG 19 >
<:FILE$PUTS .$F "?type?">)>>>
>DONE >
<SET PROCLIST <CONS :PT_INFIXOP .PROCLIST>> 

<DEFINE :PT_INFIXOP ( $OP $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($OP )<LIST FIX ANY>($F )ANY )
<PROG ($S )#DECL ( ($S )STRING )

<PROG (OLDGUY) #DECL ((OLDGUY) <LIST FIX ANY>) <SET OLDGUY .$OP ><PROG (TG $OP ) #DECL ((TG) FIX) <SET TG <NTH .OLDGUY 1>><SET $OP <NTH .OLDGUY 2>> <COND 
(<==? .TG 20 >
<SET $S "**">)
(<==? .TG 12 >
<SET $S "//">)
(<==? .TG 6 >
<SET $S "/">)
(<==? .TG 13 >
<SET $S "*">)
(<==? .TG 4 >
<SET $S "||">)
(<==? .TG 1 >
<SET $S "+">)
(<==? .TG 21 >
<SET $S "-">)
(<==? .TG 11 >
<SET $S "<">)
(<==? .TG 15 >
<SET $S "~>=">)
(<==? .TG 10 >
<SET $S "<=">)
(<==? .TG 16 >
<SET $S "~>">)
(<==? .TG 9 >
<SET $S ">">)
(<==? .TG 17 >
<SET $S "~<=">)
(<==? .TG 8 >
<SET $S ">=">)
(<==? .TG 18 >
<SET $S "~<">)
(<==? .TG 7 >
<SET $S "=">)
(<==? .TG 14 >
<SET $S "~=">)
(<==? .TG 2 >
<SET $S "&">)
(<==? .TG 3 >
<SET $S "cand">)
(<==? .TG 19 >
<SET $S "|">)
(<==? .TG 5 >
<SET $S "cor">)>>>
<:FILE$PUTS .$F .$S >
>DONE >
<SET PROCLIST <CONS :PT_INFIX .PROCLIST>> 

<DEFINE :PT_INFIX ( $INF $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($INF )<VECTOR ANY <LIST FIX ANY>ANY >($F )ANY )
<PROG ($LP $CP $RP )#DECL ( ($LP )FIX ($CP )FIX ($RP )FIX )

<SET $LP <:GET_EXPR_PREC <RECORD$GET 1 .$INF >>>
<SET $CP <:GET_PREC <RECORD$GET 2 .$INF >>>
<SET $RP <:GET_EXPR_PREC <RECORD$GET 3 .$INF >>>
<COND (<OR <INT$LT .$LP .$CP ><AND <INT$EQUAL .$CP 5 ><INT$EQUAL .$LP 5 >>>
<PROG ()
<:FILE$PUTC .$F #CHARACTER 40 >
<:PT_EXPR <RECORD$GET 1 .$INF >.$F >
<:FILE$PUTC .$F #CHARACTER 41 >
>)(T 
<:PT_EXPR <RECORD$GET 1 .$INF >.$F >)>
<:FILE$PUTC .$F #CHARACTER 32 >
<:PT_INFIXOP <RECORD$GET 2 .$INF >.$F >
<:FILE$PUTC .$F #CHARACTER 32 >
<COND (<AND <INT$LE .$RP .$CP ><APPLYOP :CAND$TYPE NOT <AND <INT$EQUAL .$CP 5 ><INT$EQUAL .$RP 5 >>() >>
<PROG ()
<:FILE$PUTC .$F #CHARACTER 40 >
<:PT_EXPR <RECORD$GET 3 .$INF >.$F >
<:FILE$PUTC .$F #CHARACTER 41 >
>)(T 
<:PT_EXPR <RECORD$GET 3 .$INF >.$F >)>
>DONE >
<SET PROCLIST <CONS :GET_EXPR_PREC .PROCLIST>> 

<DEFINE :GET_EXPR_PREC ( $X  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($X )ANY (VALUE)FIX )
<PROG ($XA )#DECL ( ($XA )<LIST FIX ANY>)

<SET $XA <:EXPR$GET_ABS .$X >>
<PROG (OLDGUY) #DECL ((OLDGUY) <LIST FIX ANY>) <SET OLDGUY .$XA ><PROG (TG $XA ) #DECL ((TG) FIX) <SET TG <NTH .OLDGUY 1>><SET $XA <NTH .OLDGUY 2>> <COND 
(<==? .TG 11 >
<RETURN <:GET_PREC <RECORD$GET 2 .$XA >>.RTN >)(T 
<RETURN 6 .RTN >)>>>
><:RETURN-ERROR>>
<SETG :GET_EXPR_PREC$TYPE :INT >
<SET PROCLIST <CONS :GET_PREC .PROCLIST>> 

<DEFINE :GET_PREC ( $OP  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($OP )<LIST FIX ANY>(VALUE)FIX )
<PROG ()

<PROG (OLDGUY) #DECL ((OLDGUY) <LIST FIX ANY>) <SET OLDGUY .$OP ><PROG (TG $OP ) #DECL ((TG) FIX) <SET TG <NTH .OLDGUY 1>><SET $OP <NTH .OLDGUY 2>> <COND 
(<==? .TG 20 >
<RETURN 5 .RTN >)
(<OR <==? .TG 12 ><==? .TG 6 ><==? .TG 13 >>
<RETURN 4 .RTN >)
(<OR <==? .TG 4 ><==? .TG 1 ><==? .TG 21 >>
<RETURN 3 .RTN >)
(<OR <==? .TG 11 ><==? .TG 15 ><==? .TG 10 ><==? .TG 16 ><==? .TG 9 ><==? .TG 17 ><==? .TG 8 ><==? .TG 18 ><==? .TG 7 ><==? .TG 14 >>
<RETURN 2 .RTN >)
(<OR <==? .TG 2 ><==? .TG 3 >>
<RETURN 1 .RTN >)
(<OR <==? .TG 19 ><==? .TG 5 >>
<RETURN 0 .RTN >)>>>
><:RETURN-ERROR>>
<SETG :GET_PREC$TYPE :INT >
<SET PROCLIST <CONS :PT_GET_SUGAR .PROCLIST>> 

<DEFINE :PT_GET_SUGAR ( $REF $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($REF )<VECTOR ANY ANY >($F )ANY )
<PROG ()

<:PT_EXPR <RECORD$GET 1 .$REF >.$F >
<:FILE$PUTC .$F #CHARACTER 46 >
<:PT_NAME <RECORD$GET 2 .$REF >.$F >
>DONE >
<SET PROCLIST <CONS :PT_FETCH_SUGAR .PROCLIST>> 

<DEFINE :PT_FETCH_SUGAR ( $REF $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($REF )<VECTOR ANY ANY >($F )ANY )
<PROG ()

<:PT_EXPR <RECORD$GET 2 .$REF >.$F >
<:FILE$PUTC .$F #CHARACTER 91 >
<:PT_EXPR <RECORD$GET 1 .$REF >.$F >
<:FILE$PUTC .$F #CHARACTER 93 >
>DONE >
<SET PROCLIST <CONS :PT_ARRAYCONS .PROCLIST>> 

<DEFINE :PT_ARRAYCONS ( $CONS $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($CONS )<VECTOR <VECTOR UVECTOR FIX FIX FIX><LIST FIX ANY>ANY >($F )ANY )
<PROG ($MX )#DECL ( ($MX )<LIST FIX ANY>)

<:PT_TYPESPEC <RECORD$GET 3 .$CONS >.$F >
<:FILE$PUTS .$F "$[">
<SET $MX <RECORD$GET 2 .$CONS >>
<PROG (OLDGUY) #DECL ((OLDGUY) <LIST FIX ANY>) <SET OLDGUY .$MX ><PROG (TG $MX ) #DECL ((TG) FIX) <SET TG <NTH .OLDGUY 1>><SET $MX <NTH .OLDGUY 2>> <COND 
(<==? .TG 2 >
<PROG ()
<:PT_EXPR .$MX .$F >
<:FILE$PUTS .$F ": ">
>)
(<==? .TG 1 >
#FALSE () )>>>
<:PT_EXPRLIST <RECORD$GET 1 .$CONS >.$F >
<:FILE$PUTC .$F #CHARACTER 93 >
>DONE >
<SET PROCLIST <CONS :PT_FIELD .PROCLIST>> 

<DEFINE :PT_FIELD ( $FLD $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($FLD )<VECTOR <VECTOR UVECTOR FIX FIX FIX>ANY >($F )ANY )
<PROG ()

<:PT_NAMELIST <RECORD$GET 1 .$FLD >.$F >
<:FILE$PUTS .$F ": ">
<:PT_EXPR <RECORD$GET 2 .$FLD >.$F >
>DONE >
<SET PROCLIST <CONS :PT_FIELDLIST .PROCLIST>> 

<DEFINE :PT_FIELDLIST ( $LIST $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($LIST )<VECTOR UVECTOR FIX FIX FIX>($F )ANY )
<PROG ($HIGH )#DECL ( ($HIGH )FIX )

<SET $HIGH <ARRAY$HIGH .$LIST >>
<PROG ($I K I)#DECL (($I K I)FIX)<SET I <ARRAY$LOW .$LIST >><SET K .$HIGH ><SET $I .I><REPEAT () <COND (<L? .K .$I > <RETURN>)> 
<PROG ()
<:PT_FIELD <ARRAY$FETCH .$LIST .$I >.$F >
<COND (<INT$LT .$I .$HIGH >
<PROG ()
<:FILE$PUTC .$F #CHARACTER 44 >
<:PT_NEWLINE .$F >
>)(T 
#FALSE () )>
><SET $I <+ 1 .$I >>>>
>DONE >
<SET PROCLIST <CONS :PT_RECORDCONS .PROCLIST>> 

<DEFINE :PT_RECORDCONS ( $CONS $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($CONS )<VECTOR <VECTOR UVECTOR FIX FIX FIX>ANY >($F )ANY )
<PROG ($MARGIN )#DECL ( ($MARGIN )FIX )

<SET $MARGIN <:GET_MARGIN >>
<:PT_TYPESPEC <RECORD$GET 2 .$CONS >.$F >
<:FILE$PUTS .$F "${">
<:NEW_MARGIN .$F >
<:PT_FIELDLIST <RECORD$GET 1 .$CONS >.$F >
<:FILE$PUTC .$F #CHARACTER 125 >
<:SET_MARGIN .$MARGIN >
>DONE >
<SET PROCLIST <CONS :PT_BRACKETREF .PROCLIST>> 

<DEFINE :PT_BRACKETREF ( $REF $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($REF )<VECTOR ANY <VECTOR UVECTOR FIX FIX FIX>>($F )ANY )
<PROG ()

<:PT_IDN <RECORD$GET 1 .$REF >.$F >
<:PT_CONSTLIST <RECORD$GET 2 .$REF >.$F >
>DONE >
<SET PROCLIST <CONS :PT_EXPR .PROCLIST>> 

<DEFINE :PT_EXPR ( $EX $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($EX )ANY ($F )ANY )
<PROG ()

<:PT_EXPRABS <:EXPR$GET_ABS .$EX >.$F >
>DONE >
<SET PROCLIST <CONS :PT_EXPRABS .PROCLIST>> 

<DEFINE :PT_EXPRABS ( $EA $F  "OPTIONAL" (HANDLERS ()) "NAME" RTN)
#DECL ( ($EA )<LIST FIX ANY>($F )ANY )
<PROG ($X )#DECL ( ($X )<LIST FIX ANY>)

<SET $X .$EA >
<PROG (OLDGUY) #DECL ((OLDGUY) <LIST FIX ANY>) <SET OLDGUY .$X ><PROG (TG $X ) #DECL ((TG) FIX) <SET TG <NTH .OLDGUY 1>><SET $X <NTH .OLDGUY 2>> <COND 
(<==? .TG 11 >
<:PT_INFIX .$X .$F >)
(<==? .TG 16 >
<:FILE$PUTS .$F "nil">)
(<==? .TG 4 >
<:FILE$PUTS .$F <COND (.$X "true") (T "false")> >)
(<==? .TG 20 >
<:PT_STRID .$X .$F >)
(<==? .TG 12 >
<:PT_INTID .$X .$F >)
(<==? .TG 5 >
<:PT_CHARID .$X .$F >)
(<==? .TG 10 >
<:PT_IDN .$X .$F >)
(<==? .TG 15 >
<PROG ()
<:FILE$PUTC .$F #CHARACTER 126 >
<:PT_EXPR .$X .$F >
>)
(<==? .TG 14 >
<PROG ()
<:FILE$PUTC .$F #CHARACTER 45 >
<:PT_EXPR .$X .$F >
>)
(<==? .TG 9 >
<:PT_GET_SUGAR .$X .$F >)
(<==? .TG 7 >
<:PT_FETCH_SUGAR .$X .$F >)
(<==? .TG 13 >
<:PT_INVOKE .$X .$F >)
(<==? .TG 1 >
<:PT_ARRAYCONS .$X .$F >)
(<==? .TG 18 >
<:PT_RECORDCONS .$X .$F >)
(<==? .TG 2 >
<:PT_APPLY .$X .$F >)
(<==? .TG 17 >
<:PT_CLUSTEROP .$X .$F >)
(<==? .TG 8 >
<PROG ()
<:FILE$PUTS .$F "force[">
<:PT_TYPESPEC .$X .$F >
<:FILE$PUTC .$F #CHARACTER 93 >
>)
(<==? .TG 21 >
<PROG ()
<:FILE$PUTS .$F "up(">
<:PT_EXPR .$X .$F >
<:FILE$PUTC .$F #CHARACTER 41 >
>)
(<==? .TG 6 >
<PROG ()
<:FILE$PUTS .$F "down(">
<:PT_EXPR .$X .$F >
<:FILE$PUTC .$F #CHARACTER 41 >
>)
(<==? .TG 19 >
<:PT_BRACKETREF .$X .$F >)
(<==? .TG 3 >
<:FILE$PUTS .$F "?expr?">)>>>
>DONE >
